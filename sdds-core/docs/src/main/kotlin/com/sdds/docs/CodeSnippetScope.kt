package com.sdds.docs

/**
 * Скоуп для описания код-сниппетов, используемых в документации.
 *
 * Все функции внутри этого скоупа предназначены **только** для документационных примеров
 * и не влияют на реальное поведение приложения.
 *
 * Код, написанный внутри [codeSnippet], может анализироваться специальными инструментами
 * (например, Gradle-задачей), извлекаться в отдельные файлы и встраиваться в документацию.
 */
class CodeSnippetScope {

    /**
     * Маркер для подмены значения в документационном сниппете.
     *
     * В реальном коде функция просто возвращает [value] без изменений.
     * При генерации документации вызов `placeholder(...)` может быть заменён
     * на строку [replace], чтобы показать более наглядный или абстрактный пример.
     *
     * @param value реальное значение, используемое в рабочем коде
     * @param replace строковое представление, которое будет показано в документации
     */
    fun <T> placeholder(value: T, replace: String): T = value
}

/**
 * Оборачивает код в документационный сниппет.
 *
 * Код внутри [block] выполняется как обычный Kotlin-код, но при этом может быть
 * автоматически извлечён и использован для генерации документации
 * (например, в виде примеров использования компонентов).
 *
 * Обычно используется вместе с [CodeSnippetScope.placeholder] для подмены значений,
 * которые должны выглядеть иначе в документации, чем в реальном коде.
 */
inline fun codeSnippet(block: CodeSnippetScope.() -> Unit) {
    val scope = CodeSnippetScope()
    scope.block()
}
